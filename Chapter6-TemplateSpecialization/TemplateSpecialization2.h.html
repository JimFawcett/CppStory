<pre>#pragma once
///////////////////////////////////////////////////////////////
// TemplateSpecialization.h - template specialization demo   //
//                                                           //
// Jim Fawcett, Teaching Professor Emeritus, Syracuse Univ   //
///////////////////////////////////////////////////////////////

#include &lt;iostream&gt;
#include &lt;iomanip&gt;
#include &lt;type_traits&gt;
//#include "Timer.h"

namespace Chap6 {

  /*--------------------------------------------------------- 
    unspecialized template class
    - U is a placeholder, used only to provide a place for
      specialization.
    - This is a simple demo, but could easily be expanded
      into a useful facility
  ---------------------------------------------------------*/

  struct TNull {};

  template&lt;typename S&gt;
  struct FNull {};

  template&lt;
    typename S, 
    template&lt;typename&gt; typename F = FNull, 
    typename T = TNull&gt;
  class Logger { 
    /*-- used to set specialization structure */ 
  };

  template&lt;typename S&gt;
  class Logger&lt;S, FNull, TNull&gt; {
  public:
    Logger(std::ostream* pStr) : pStream_(pStr) {}
    ~Logger() {}
    void write(S s) {
      (*pStream_) &lt;&lt; prefix_ &lt;&lt; s;
    }
  private:
    std::string prefix_ = "\n  ";
    std::ostream* pStream_;
  };

  /*---------------------------------------------------------
    template class partial specialization on Formatter class
    Formatter class used to specialize Logger&lt;S,Formatter,T&gt;
    - this is partial class specialization since S is
      still unspecified
  ---------------------------------------------------------*/

  template&lt;typename S&gt;
  struct Formatter {
    const char* prefix_ = "\n  &lt;-- ";
    const char* suffix_ = " --&gt;";
    std::string transform(const S&amp; s) {
      return prefix_ + s + suffix_;
    }
  };

  template&lt;typename S, template&lt;typename&gt; typename F&gt;
  class Logger&lt;S, F, TNull&gt; {
  public:
    Logger(std::ostream* pStr) : pStream_(pStr) {}
    ~Logger() {}
    void write(S s) {
      (*pStream_) &lt;&lt; f.transform(s);
    }
  private:
    std::string prefix_ = "\n  ";
    std::ostream* pStream_;
    F&lt;S&gt; f;
  };
  
  /*---------------------------------------------------------
    template class partial specialization on Timer class
    - See Timer.h for details
  ---------------------------------------------------------*/

  template&lt;typename S, typename T&gt;
  class Logger&lt;S, FNull, T&gt; {
  public:
    Logger(std::ostream* pStr) : pStream_(pStr) {}
    ~Logger() {
      timer_.stop();
    }
    void start() {
      timer_.start();
    }
    void stop() {
      timer_.stop();
    }
    void write(S s) {
      (*pStream_) &lt;&lt; prefix_ &lt;&lt; std::setw(6) 
                  &lt;&lt; timer_.elapsedMicroseconds() 
                  &lt;&lt; " microsec : " &lt;&lt; s;
    }
  private:
    std::string prefix_ = "\n  ";
    T timer_;
    std::ostream* pStream_;
  };
}</pre>